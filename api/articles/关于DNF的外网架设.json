{"title":"关于DNF的外网架设（第一部分）","slug":"关于DNF的外网架设","date":"2018-01-28T05:50:11.000Z","updated":"2018-03-21T07:04:02.977Z","comments":true,"path":"api/articles/关于DNF的外网架设.json","photos":[],"link":"","excerpt":"第一部分：服务端架设<br>","covers":["https://s1.ax1x.com/2018/03/18/9oJBDg.jpg","https://s1.ax1x.com/2018/03/21/978MR0.md.jpg","https://s1.ax1x.com/2018/03/21/978mIs.jpg","https://s1.ax1x.com/2018/03/21/978eaj.jpg","https://s1.ax1x.com/2018/03/21/978KGq.jpg","https://s1.ax1x.com/2018/03/21/9788LF.jpg","https://s1.ax1x.com/2018/03/21/978Eqg.jpg","https://s1.ax1x.com/2018/03/21/978ZZQ.md.jpg","https://s1.ax1x.com/2018/03/21/97J9jf.jpg","https://s1.ax1x.com/2018/03/21/9783sU.jpg"],"content":"<p>第一部分：服务端架设<br><a id=\"more\"></a><br><img src=\"https://s1.ax1x.com/2018/03/18/9oJBDg.jpg\" alt=\"9oJBDg.jpg\"><br>需要准备以下条件：<br>                 云服务器（是服务器，不是虚拟主机，且至少1G1H）<br>                 预装centos5.8或5.11系统（5系列启动速度快，但yum源缺少，下面会提到）<br>                 需要软件Xshell 5、WinSCP、navicat<br>                 DNF服务端</p>\n<h1 id=\"买服务器\"><a href=\"#买服务器\" class=\"headerlink\" title=\"买服务器\"></a>买服务器</h1><pre><code>推荐使用阿里云，腾讯云\n==注意：服务器很多端口默认关闭，需要在安全组里面打开所有端口==\n\n\n\n  以下我将采用腾讯云\n  centos5.8系统\n  1H2G\n</code></pre><h1 id=\"下载软件和服务端\"><a href=\"#下载软件和服务端\" class=\"headerlink\" title=\"下载软件和服务端\"></a>下载软件和服务端</h1><pre><code>Xshell 5：百度下载\nWinSCP：百度下载\nnavicat：百度下载\n服务端下载地址：\n链接：https://pan.baidu.com/s/1c3cfCOg 密码：h1uu\n</code></pre><h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><p>One.上传服务端到服务器端的/root目录下</p>\n<p> <img src=\"https://s1.ax1x.com/2018/03/21/978MR0.md.jpg\" alt=\"978MR0.md.jpg\"></p>\n<p>Two.用Xshell远程连接腾讯云</p>\n<p>#关闭防火墙和防火墙自启<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service iptables stop</span><br><span class=\"line\">chkconfig iptables off</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"安装支持库\"><a href=\"#安装支持库\" class=\"headerlink\" title=\"安装支持库\"></a>安装支持库</h1><p><img src=\"https://s1.ax1x.com/2018/03/21/978mIs.jpg\" alt=\"978mIs.jpg\"><br>                                                                                                   //个别可能没有安装包可供安装，没关系<br>    <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install glibc.i386</span><br><span class=\"line\">yum -y install xulrunner.i386               </span><br><span class=\"line\">yum -y install libXtst.i386</span><br><span class=\"line\">yum -y install gcc gcc-c++ make zlib-devel</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"数据库开机启动\"><a href=\"#数据库开机启动\" class=\"headerlink\" title=\"数据库开机启动\"></a>数据库开机启动</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig mysqld on</span><br></pre></td></tr></table></figure>\n<h1 id=\"解压下载的文件\"><a href=\"#解压下载的文件\" class=\"headerlink\" title=\"解压下载的文件\"></a>解压下载的文件</h1><p><img src=\"https://s1.ax1x.com/2018/03/21/978eaj.jpg\" alt=\"978eaj.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf ./DNFServer.tar.gz -C /</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"设置对应权限\"><a href=\"#设置对应权限\" class=\"headerlink\" title=\"设置对应权限\"></a>设置对应权限</h1><p>给予home root mysql文件夹777权限<br><img src=\"https://s1.ax1x.com/2018/03/21/978KGq.jpg\" alt=\"978KGq.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod -R <span class=\"number\">777</span> /home</span><br><span class=\"line\">chmod -R <span class=\"number\">777</span> /root</span><br><span class=\"line\">chmod -R <span class=\"number\">777</span> /var/lib/mysql</span><br><span class=\"line\">chown -R mysql.mysql /var/lib/mysql/</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"重启数据库\"><a href=\"#重启数据库\" class=\"headerlink\" title=\"重启数据库\"></a>重启数据库</h1><p>==注意：如果重启失败，请重启一下服务器再次尝试==<br><img src=\"https://s1.ax1x.com/2018/03/21/9788LF.jpg\" alt=\"9788LF.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysqld restart</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"编译GeoIP\"><a href=\"#编译GeoIP\" class=\"headerlink\" title=\"编译GeoIP\"></a>编译GeoIP</h1><p><img src=\"https://s1.ax1x.com/2018/03/21/978Eqg.jpg\" alt=\"978Eqg.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /home/GeoIP<span class=\"number\">-1.4</span><span class=\"number\">.8</span>/</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make clean</span><br><span class=\"line\">make</span><br><span class=\"line\">make check</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"修改对应位置的外网IP\"><a href=\"#修改对应位置的外网IP\" class=\"headerlink\" title=\"修改对应位置的外网IP\"></a>修改对应位置的外网IP</h1><p>用Navicat打开数据库d_taiwan的db_connect表，把db_ip字段所有的192.168.200.131改成你的外网IP。<br>连接地址：你服务器的公网ip<br>账号game  密码uu5!^%jg<br><img src=\"https://s1.ax1x.com/2018/03/21/978ZZQ.md.jpg\" alt=\"978ZZQ.md.jpg\"></p>\n<p>#服务端程序里面的用命令改，注意把“你的外网IP”替换成你的外网IP<br><img src=\"https://s1.ax1x.com/2018/03/21/97J9jf.jpg\" alt=\"97J9jf.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /home/dxf/</span><br><span class=\"line\">sed -i <span class=\"string\">\"s/192.168.200.131/这个位置填你外网ip/g\"</span> `find . -type f -name <span class=\"string\">\"*.tbl\"</span>`</span><br><span class=\"line\">sed -i <span class=\"string\">\"s/192.168.200.131/这个位置填你外网ip/g\"</span> `find . -type f -name <span class=\"string\">\"*.cfg\"</span>`</span><br></pre></td></tr></table></figure></p>\n<p>#虚拟内存<br><img src=\"https://s1.ax1x.com/2018/03/21/9783sU.jpg\" alt=\"9783sU.jpg\"><br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /var/</span><br><span class=\"line\">dd <span class=\"keyword\">if</span>=/dev/zero of=swapfile bs=<span class=\"number\">1</span>M count=<span class=\"number\">8192</span></span><br><span class=\"line\">mkswap swapfile </span><br><span class=\"line\">swapon swapfile</span><br><span class=\"line\">echo /var/swapfile swap swap defaults <span class=\"number\">0</span> <span class=\"number\">0</span>  &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure></p>\n<p>服务端架设到此结束</p>\n","categories":[],"tags":[]}